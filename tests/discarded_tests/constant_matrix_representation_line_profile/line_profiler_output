Timer unit: 1e-06 s

Total time: 0.000969 s
File: run.py
Function: forward at line 17

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    17                                               @profile
    18                                               def forward(self, input, n_instances):
    19                                                   #   n_instances.type(torch.long)
    20                                                   
    21         1        390.0    390.0     40.2          NN_out = self.prepNN(input) # Forward all indices through neural network
    22                                                   # print("DEBUG: NNout - {}".format(NN_out))
    23                                                   
    24         1         71.0     71.0      7.3          output = torch.empty(size = (input.size(0), len(NN_out[0][0])), dtype = torch.double) # Pre-alocate tensor for output
    25                                                   # print("DEBUG: empty output - {}".format(output))
    26                                           
    27         5         32.0      6.4      3.3          for i, n in enumerate(n_instances):
    28         4        307.0     76.8     31.7              output[i] = self.aggregation_func(NN_out[i, :n], dim = 0) # Aggregates only valid instances
    29                                                       
    30         1        168.0    168.0     17.3          output = self.afterNN(output)
    31                                                   
    32         1          1.0      1.0      0.1          return output

