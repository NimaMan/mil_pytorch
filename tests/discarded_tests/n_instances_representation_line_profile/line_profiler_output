Timer unit: 1e-06 s

Total time: 0.000989 s
File: run.py
Function: forward at line 18

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    18                                               @profile
    19                                               def forward(self, input, n_instances):    
    20         1        307.0    307.0     31.0          NN_out = self.prepNN(input) # Forward all instances through neural network
    21         1         63.0     63.0      6.4          output = torch.empty(n_instances.size(0), len(NN_out[0])) # Allocates empty tensor for aggregated output
    22                                                   
    23         5          9.0      1.8      0.9          for i in range(len(n_instances)):
    24         4        119.0     29.8     12.0              start = torch.sum(n_instances[:i])
    25         4         68.0     17.0      6.9              end = start + n_instances[i]
    26         4        302.0     75.5     30.5              output[i] = self.aggregation_func(NN_out[start:end], dim = 0)
    27                                                   
    28         1        121.0    121.0     12.2          output = self.afterNN(output.double())
    29                                                   
    30         1          0.0      0.0      0.0          return output

